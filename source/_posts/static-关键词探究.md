---
title: static 关键词探究
categories:
- C++
- 侯捷老师视频
date: 2021-01-27 20:36:48
tags:
- C++
- 侯捷
- 内存分配
- static
- 静态函数
- 静态成员
- 声明与定义
- 作用域
---

​		

## 一. 在类中

​		C++中static关键词在类中的作用是声明一个静态成员。类的静态成员不与类的对象直接关联，而是与类本身直接关联。其使用方式为：声明成员时在其前加上static限定。

​		静态数据成员为全体对象所共有，所有对象都可以直接访问它；但是，因为它又不独属于类的任何一个对象，所以在它不会在创建类的对象时被定义，即不会被类的构造函数初始化。而定义类的内部成员数据只是一个声明，并没有被定义，因此，必须在类的外部定义和初始化每个静态成员。

​		不过，《C++ primer 5th 中文版》在270页提到，“一般情况下，类的静态成员不应该在类的内部初始化。然而，我们可以为静态成员提供const整数类型的内部初始化，不过要求静态成员必须是字面值常量类型的constexpr。初始值必须是常量表达式。 若这个静态成员的应用场景仅限于编译器可以替换它的值的情况时，则一个const或constexpr static不需要分别定义。相反，若它们用于值不能替换的场景中，则该成员必须有一条定义语句。在类的内部提供了一个初始值后，则成员的定义就不能再指定一个初始值了。”那么，其实不管有没有类内初始化，都在外部定义一下该成员就好了。

​		对于静态函数成员，既可以在类的内部定义也可以在类的外部定义，但在外部定义时，不要重复static关键字。静态成员函数内没有隐式的this指针参数，因此不能在其函数体内使用this指针，且不能将静态成员函数声明为const的（声明为const意味着这个函数不会改变其this指针所属对象的属性，但是静态成员函数不含this指针）。



## 二. 在局部作用域中定义一个全局变量

​		每一个变量都有的它的生命周期，当一个变量在形参或函数体内被定义时，程序出了函数体后这个变量的生命也就结束了，将会被销毁，这种变量称之为局部变量；但如果加上static关键词的限制则可以无视此规则，将成为一个局部静态对象，生命周期为从它被定义开始到程序终止。